{% extends 'main/base.html' %}

	
	{% block content %}
	{% load static %}


	<div id="mainBody">
		<div class="container">
			<div class="row">
				<!-- Sidebar ================================================== -->
				<div id="sidebar" class="span3">
					{% if profile %}
					<div class="well well-small">
						<a id="myCart" href="/cart/"><img src="{% static 'main/images/ico-cart.png' %}" alt="cart"><span id="cartItems">0</span> Items in your cart</a>
					</div>
					{% endif %}
					<ul id="sideManu" class="nav nav-tabs nav-stacked">
						{% for category in categories %}
						<li class="subMenu open"><a>{{ category.name }}</a>
							<ul>
								{% for subcategory in category.subcategories %}
								<li>
									<a class="active" href="/category/{{ subcategory.id }}"><i class="icon-chevron-right"></i>{{ subcategory.name }} ({{ subcategory.numproducts }})</a>
								</li>				
								{% endfor %}
							</ul>
						</li>
						{% endfor %}
					</ul>

					<br/>

					<!--
			  		<div class="thumbnail">
						<img src="{% static 'main/images/products/panasonic.jpg' %}" alt="Bootshop panasonoc New camera"/>
						<div class="caption">
				  			<h5>Panasonic</h5>
							<h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#"><i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">$222.00</a></h4>
						</div>
			  		</div>

			  		<br/>

					<div class="thumbnail">
						<img src="{% static 'main/images/products/kindle.png' %}" title="Bootshop New Kindel" alt="Bootshop Kindel">
						<div class="caption">
					  		<h5>Kindle</h5>
					    	<h4 style="text-align:center"><a class="btn" href="product_details.html"> <i class="icon-zoom-in"></i></a> <a class="btn" href="#"><i class="icon-shopping-cart"></i></a> <a class="btn btn-primary" href="#">$222.00</a></h4>
						</div>
				  	</div>

				  	<br/>
				
					<div class="thumbnail">
						<img src="{% static 'main/images/payment_methods.png' %}" title="Bootshop Payment Methods" alt="Payments Methods">
						<div class="caption">
					  		<h5>Payment Methods</h5>
						</div>
				  </div>
					-->

				</div>
				<!-- Sidebar end=============================================== -->
	

				<div class="span9">
    				<ul class="breadcrumb">
						<li><a href="/">Home</a> <span class="divider">/</span></li>
						<li class="active">{{ curcategory.name }}</li>
    				</ul>
	
					<!--
					<form class="form-horizontal span6">
						<div class="control-group">
		  					<label class="control-label alignL">Sort By </label>
							<select>
              					<option>Priduct name A - Z</option>
              					<option>Priduct name Z - A</option>
              					<option>Priduct Stoke</option>
              					<option>Price Lowest first</option>
            				</select>
						</div>
	  				</form>
	  			-->
	  
	  			<!--
					<div id="myTab" class="pull-right">
 						<a href="#listView" data-toggle="tab"><span class="btn btn-large"><i class="icon-list"></i></span></a>
 						<a href="#blockView" data-toggle="tab"><span class="btn btn-large btn-primary"><i class="icon-th-large"></i></span></a>
					</div>
				-->
					<br class="clr"/>

					<div class="tab-content">
						<div class="tab-pane" id="listView">
							{% for item in products %}
							<div class="row">	  
								<div class="span2">
									<img src="/media/{{ item.image }}" alt=""/>
								</div>
								<div class="span4">
									<h3>New | Available</h3>				
									<hr class="soft"/>
									<h5>{{ item.name }}</h5>
									<p>
										{{item.name}}
									</p>
									<a class="btn btn-small pull-right" href="product_details.html">View Details</a>
									<br class="clr"/>
								</div>
								<div class="span3 alignR">
									<form class="form-horizontal qtyFrm">
										<h3>&#8377; {{ item.price }}</h3>
										<label class="checkbox">
										<input type="checkbox">  Adds product to compair
										</label><br/>
					
					  					<a href="product_details.html" class="btn btn-large btn-primary"> <i class=" icon-shopping-cart"></i></a>
					  					<a href="product_details.html" class="btn btn-large"><i class="icon-zoom-in"></i></a>		
									</form>
								</div>
							</div>
					
							<hr class="soft"/>					
							{% endfor %}
						</div>					

						<div class="tab-pane  active" id="blockView">
							<ul class="thumbnails">
								{% for item in products %}
								<li class="span3">
			  						<div class="thumbnail">
										<a href="/productdetails/{{item.id}}"><img src="/media/{{ item.image }}" style="height:280px;width:140px" alt=""/></a>
										<div class="caption">
				  							<h5>{{ item.name }}</h5>
				  							<p> 
												{{ item.brandid.name }} 
				  							</p>
				   							<h5 style="text-align:center"><!--<a class="btn" href="product_details.html"> <i  class="icon-zoom-in"></i></a>--><span class="btn"><i class="icon-shopping-cart" onclick="AddCart({{item.id}});"></i></span> <a class="btn btn-primary" href="#">&#8377; {{ item.price }}</a></h5>
										</div>
			  						</div>
								</li>	
								{% endfor %}		
		  					</ul>						
							<hr class="soft"/>
						</div>
					</div>

					<!--
					<div class="pagination" style="margin:0px auto;width:280px;">
						<ul>
							<li><a href="#">&lsaquo;</a></li>
							<li><a href="#">1</a></li>
							<li><a href="#">2</a></li>
							<li><a href="#">3</a></li>
							<li><a href="#">4</a></li>
							<li><a href="#">...</a></li>
							<li><a href="#">&rsaquo;</a></li>
						</ul>
					</div>
				-->
					<br class="clr"/>
				</div>
			</div>
		</div>
	</div>
	<!-- MainBody End ============================= -->


	<script>
		function AddCart(productid)
		{
			xhr=new XMLHttpRequest();
			xhr.open('GET','/cart/add/'+productid);
			xhr.send();
			xhr.onreadystatechange=function()
			{
				if(xhr.readyState==4)
				{
					response_data=JSON.parse(xhr.responseText);
					if(response_data.response=="User Not Logged In" && productid!=0)
					{
						$("#login").modal();
					}
					else if(response_data.response=='Duplicate Record')
					{
						alert('Item Already Exist in Your Cart');
					}
					else
					{
						document.getElementById('cartItems').innerHTML=response_data['cartitems'];
						document.getElementById('cartItemMenu').innerHTML=response_data['cartitems'];
					}
				}
			}
		}

		onload=function()
		{
			AddCart(0);
		}
	</script>
	{% endblock %}

